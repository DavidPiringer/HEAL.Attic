# HEAL.Attic Benchmarks
Benchmarking results for `HEAL.Attic.Benchmarks` are shown in the tables below.

Hardware Specs:  
Intel(R) Core(TM) i7-6600U CPU @ 2.60GHz, 2 Core(s), 4 Logical Processor(s)  
Physical Memory (RAM)	16.0 GB
Microsoft Windows 10 Education  
.NET Standard 2.0 (Runtime: .NET Core 2.1)

### Array of random ints:

```csharp
      var arr = new int[size];
      for (int i = 0; i < arr.Length; i++) {
        arr[i] = rand.Next();
      }
```


| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,1 |                       0,0 |           39,2 |                    4,9 |
|    16384 |                     0,1 |                       0,1 |           78,1 |                    4,9 |
|    32768 |                     1,4 |                       0,1 |          156,1 |                    4,9 |
|    65536 |                     4,6 |                       1,7 |          312,0 |                    4,9 |
|   131072 |                    13,2 |                       5,0 |          624,1 |                    4,9 |
|   262144 |                    26,8 |                      10,9 |        1.247,8 |                    4,9 |
|   524288 |                    53,2 |                      23,8 |        2.495,4 |                    4,9 |
|  1048576 |                   112,8 |                      49,6 |        4.990,6 |                    4,9 |
|  2097152 |                   228,5 |                     100,8 |        9.981,7 |                    4,9 |

The ProtoBuf encoding has an overhead of one byte per int when the range of values covers almost the whole int range. However, if only a limited range of values is possible then the ProtoBuf encoding will  have significant benefits (as shown below). 

### Array of ints from limited range:
```csharp
      int maxInt = 20;
      var arr = new int[size];
      for (int i = 0; i < arr.Length; i++) {
        arr[i] = rand.Next(maxInt);
      }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,0 |            8,1 |                    1,0 |
|    16384 |                     0,1 |                       0,0 |           16,1 |                    1,0 |
|    32768 |                     0,3 |                       0,2 |           32,1 |                    1,0 |
|    65536 |                     1,5 |                       0,9 |           64,1 |                    1,0 |
|   131072 |                     4,6 |                       3,1 |          128,1 |                    1,0 |
|   262144 |                    10,8 |                       8,9 |          256,1 |                    1,0 |
|   524288 |                    21,1 |                      15,6 |          512,1 |                    1,0 |
|  1048576 |                    44,6 |                      34,4 |        1.024,1 |                    1,0 |
|  2097152 |                    90,7 |                      66,5 |        2.048,1 |                    1,0 |

### Array of doubles:
```csharp
      var arr = new double[size];
      for (int i = 0; i < arr.Length; i++) {
        arr[i] = rand.NextDouble();
      }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,6 |                       0,3 |           64,1 |                    8,0 |
|    16384 |                     0,7 |                       0,4 |          128,1 |                    8,0 |
|    32768 |                     1,7 |                       1,5 |          256,1 |                    8,0 |
|    65536 |                     4,0 |                       4,4 |          512,1 |                    8,0 |
|   131072 |                     8,0 |                       8,7 |        1.024,1 |                    8,0 |
|   262144 |                    16,9 |                      18,4 |        2.048,1 |                    8,0 |
|   524288 |                    34,2 |                      41,2 |        4.096,1 |                    8,0 |
|  1048576 |                    73,6 |                      84,9 |        8.192,1 |                    8,0 |
|  2097152 |                   167,6 |                     181,0 |       16.384,1 |                    8,0 |

### List<int>:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,4 |                       0,3 |           39,1 |                    4,9 |
|    16384 |                     0,7 |                       0,4 |           78,1 |                    4,9 |
|    32768 |                     2,2 |                       0,4 |          156,1 |                    4,9 |
|    65536 |                     4,7 |                       1,5 |          312,0 |                    4,9 |
|   131072 |                     9,7 |                       3,1 |          624,1 |                    4,9 |
|   262144 |                    23,6 |                       8,1 |        1.247,8 |                    4,9 |
|   524288 |                    56,1 |                      20,8 |        2.495,4 |                    4,9 |
|  1048576 |                   115,9 |                      46,7 |        4.990,6 |                    4,9 |
|  2097152 |                   225,8 |                      93,7 |        9.981,7 |                    4,9 |

### List<int> with limited size:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,0 |            8,1 |                    1,0 |
|    16384 |                     0,0 |                       0,0 |           16,1 |                    1,0 |
|    32768 |                     0,3 |                       0,0 |           32,1 |                    1,0 |
|    65536 |                     1,7 |                       0,5 |           64,1 |                    1,0 |
|   131072 |                     4,4 |                       2,2 |          128,1 |                    1,0 |
|   262144 |                    10,5 |                       7,4 |          256,1 |                    1,0 |
|   524288 |                    20,6 |                      14,7 |          512,1 |                    1,0 |
|  1048576 |                    44,7 |                      34,4 |        1.024,1 |                    1,0 |
|  2097152 |                   102,6 |                      74,6 |        2.048,1 |                    1,0 |

### List<double>:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,1 |                       0,2 |           64,1 |                    8,0 |
|    16384 |                     0,3 |                       0,6 |          128,1 |                    8,0 |
|    32768 |                     1,6 |                       1,7 |          256,1 |                    8,0 |
|    65536 |                     4,4 |                       3,9 |          512,1 |                    8,0 |
|   131072 |                     9,7 |                       9,5 |        1.024,1 |                    8,0 |
|   262144 |                    19,2 |                      20,2 |        2.048,1 |                    8,0 |
|   524288 |                    42,6 |                      43,4 |        4.096,1 |                    8,0 |
|  1048576 |                   104,3 |                     102,6 |        8.192,1 |                    8,0 |
|  2097152 |                   266,6 |                     233,4 |       16.384,1 |                    8,0 |

### ushort[]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     1,4 |                       0,8 |           22,1 |                    2,8 |
|    16384 |                     3,1 |                       1,1 |           44,2 |                    2,8 |
|    32768 |                     6,9 |                       2,6 |           88,0 |                    2,8 |
|    65536 |                    14,2 |                       5,8 |          176,1 |                    2,8 |
|   131072 |                    31,9 |                      13,0 |          352,0 |                    2,7 |
|   262144 |                    66,6 |                      25,1 |          703,5 |                    2,7 |
|   524288 |                   129,7 |                      55,3 |        1.406,8 |                    2,7 |
|  1048576 |                   205,7 |                      97,0 |        2.813,5 |                    2,7 |
|  2097152 |                   337,9 |                     168,7 |        5.627,3 |                    2,7 |

### int[,]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,1 |           38,7 |                    4,8 |
|    16384 |                     0,1 |                       0,2 |           78,1 |                    4,9 |
|    32768 |                     1,2 |                       1,3 |          156,0 |                    4,9 |
|    65536 |                     3,8 |                       3,5 |          312,0 |                    4,9 |
|   131072 |                     9,5 |                       9,0 |          624,0 |                    4,9 |
|   262144 |                    20,4 |                      20,7 |        1.247,9 |                    4,9 |
|   524288 |                    45,9 |                      46,7 |        2.494,9 |                    4,9 |
|  1048576 |                   102,9 |                      97,9 |        4.990,6 |                    4,9 |
|  2097152 |                   206,7 |                     196,1 |        9.979,5 |                    4,9 |

### int[,,]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,1 |           38,2 |                    4,8 |
|    16384 |                     0,1 |                       0,2 |           74,4 |                    4,7 |
|    32768 |                     1,2 |                       1,2 |          142,0 |                    4,4 |
|    65536 |                     3,9 |                       3,8 |          304,9 |                    4,8 |
|   131072 |                     9,5 |                      10,4 |          595,2 |                    4,7 |
|   262144 |                    20,7 |                      21,2 |        1.190,1 |                    4,6 |
|   524288 |                    45,1 |                      44,9 |        2.436,8 |                    4,8 |
|  1048576 |                    97,2 |                      91,5 |        4.903,5 |                    4,8 |
|  2097152 |                   202,5 |                     195,9 |        9.749,4 |                    4,8 |

### int[,,,]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,9 |           31,4 |                    3,9 |
|    16384 |                     0,1 |                       3,4 |           69,8 |                    4,4 |
|    32768 |                     1,2 |                       8,1 |          136,1 |                    4,3 |
|    65536 |                     3,8 |                      19,4 |          312,1 |                    4,9 |
|   131072 |                    12,4 |                      44,3 |          620,5 |                    4,8 |
|   262144 |                    23,3 |                      84,5 |        1.115,1 |                    4,4 |
|   524288 |                    46,1 |                     164,5 |        2.175,2 |                    4,2 |
|  1048576 |                    99,9 |                     362,9 |        4.990,8 |                    4,9 |
|  2097152 |                   211,1 |                     742,7 |        9.924,4 |                    4,8 |

### Linked list:
```csharp
    [StorableType("B9C2AA20-A18C-4124-90B8-B181BF7691B4")]
    private class ListNode {
      [Storable]
      public ListNode Next;
    }
    public static object MakeLinkedList(int size, Random rand) {
      var first = new ListNode();
      var cur = first;
      for (int i = 0; i < size; i++) {
        cur.Next = new ListNode();
        cur = cur.Next;
      }
      return first;
    }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                    18,2 |                      26,6 |           96,0 |                   12,0 |
|    16384 |                    57,2 |                      80,5 |          192,0 |                   12,0 |
|    32768 |                   140,4 |                     189,4 |          400,0 |                   12,5 |
|    65536 |                   319,2 |                     406,9 |          816,0 |                   12,8 |
|   131072 |                   785,4 |                     903,8 |        1.648,0 |                   12,9 |
|   262144 |                 1.603,0 |                   1.807,2 |        3.312,0 |                   12,9 |
|   524288 |                 3.193,4 |                   3.513,9 |        6.640,0 |                   13,0 |
|  1048576 |                 6.460,4 |                   7.075,1 |       13.296,0 |                   13,0 |
|  2097152 |                13.537,1 |                  14.095,0 |       26.608,0 |                   13,0 |


### Random graph of nodes:  
```csharp
      int maxChildren = 20;
      var allNodes = new List<Node>();
      allNodes.Add(new Node()); // start with at least one node
      for (int i = 0; i < size; i++) {
        var node = new Node();
        var numChildren = rand.Next(maxChildren) + 1;
        for (int j = 0; j < numChildren; j++) {
          node.children.Add(allNodes[rand.Next(allNodes.Count)]);
        }
        allNodes.Add(node);
      }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                    57,7 |                      96,1 |          355,7 |                   44,5 |
|    16384 |                   193,0 |                     296,9 |          729,5 |                   45,6 |
|    32768 |                   532,4 |                     703,4 |        1.530,6 |                   47,8 |
|    65536 |                 1.268,1 |                   1.521,2 |        3.254,1 |                   50,8 |
|   131072 |                 2.704,6 |                   2.972,1 |        6.818,6 |                   53,3 |
|   262144 |                 5.730,6 |                   5.862,6 |       14.044,1 |                   54,9 |
|   524288 |                12.136,8 |                  11.705,7 |       28.662,8 |                   56,0 |
|  1048576 |                25.334,2 |                  23.635,6 |       57.991,0 |                   56,6 |
|  2097152 |                56.642,7 |                  48.541,3 |      118.783,6 |                   58,0 |

