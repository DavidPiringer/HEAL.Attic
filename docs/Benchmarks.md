# HEAL.Attic Benchmarks
Benchmarking results for `HEAL.Attic.Benchmarks` are shown in the tables below.

Hardware Specs:  
Intel(R) Core(TM) i7-6600U CPU @ 2.60GHz, 2 Core(s), 4 Logical Processor(s)  
Physical Memory (RAM)	16.0 GB
Microsoft Windows 10 Education  
.NET Standard 2.0

### Array of random ints:

```csharp
      var arr = new int[size];
      for (int i = 0; i < arr.Length; i++) {
        arr[i] = rand.Next();
      }
```

int[]
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,0 |           39,2 |                    4,9 |
|    16384 |                     0,1 |                       0,0 |           78,1 |                    4,9 |
|    32768 |                     1,1 |                       0,1 |          156,1 |                    4,9 |
|    65536 |                     4,7 |                       1,3 |          312,0 |                    4,9 |
|   131072 |                    12,9 |                       4,4 |          624,1 |                    4,9 |
|   262144 |                    26,0 |                       9,5 |        1.247,9 |                    4,9 |
|   524288 |                    50,7 |                      20,3 |        2.495,4 |                    4,9 |
|  1048576 |                   105,6 |                      43,0 |        4.990,6 |                    4,9 |
|  2097152 |                   204,8 |                      84,4 |        9.981,7 |                    4,9 |

The ProtoBuf encoding has an overhead of one byte per int when the range of values covers almost the whole int range. However, if only a limited range of values is possible then the ProtoBuf encoding will  have significant benefits (as shown below). 

### Array of ints from limited range:
```csharp
      int maxInt = 20;
      var arr = new int[size];
      for (int i = 0; i < arr.Length; i++) {
        arr[i] = rand.Next(maxInt);
      }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,0 |            8,1 |                    1,0 |
|    16384 |                     0,0 |                       0,0 |           16,1 |                    1,0 |
|    32768 |                     0,1 |                       0,0 |           32,1 |                    1,0 |
|    65536 |                     1,1 |                       0,1 |           64,1 |                    1,0 |
|   131072 |                     4,1 |                       1,3 |          128,1 |                    1,0 |
|   262144 |                     9,5 |                       3,8 |          256,1 |                    1,0 |
|   524288 |                    19,2 |                       9,2 |          512,1 |                    1,0 |
|  1048576 |                    41,5 |                      24,1 |        1.024,1 |                    1,0 |
|  2097152 |                    84,8 |                      52,0 |        2.048,1 |                    1,0 |

### Array of doubles:
```csharp
      var arr = new double[size];
      for (int i = 0; i < arr.Length; i++) {
        arr[i] = rand.NextDouble();
      }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,7 |                       0,2 |           64,1 |                    8,0 |
|    16384 |                     0,7 |                       0,2 |          128,1 |                    8,0 |
|    32768 |                     1,7 |                       1,2 |          256,1 |                    8,0 |
|    65536 |                     3,7 |                       3,6 |          512,1 |                    8,0 |
|   131072 |                     7,6 |                       7,7 |        1.024,1 |                    8,0 |
|   262144 |                    16,3 |                      17,0 |        2.048,1 |                    8,0 |
|   524288 |                    36,9 |                      37,6 |        4.096,1 |                    8,0 |
|  1048576 |                    77,7 |                      78,7 |        8.192,1 |                    8,0 |
|  2097152 |                   165,5 |                     160,0 |       16.384,1 |                    8,0 |

### List<int>:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,3 |                       0,3 |           39,2 |                    4,9 |
|    16384 |                     0,4 |                       0,3 |           78,1 |                    4,9 |
|    32768 |                     1,4 |                       0,3 |          156,1 |                    4,9 |
|    65536 |                     3,6 |                       1,0 |          312,0 |                    4,9 |
|   131072 |                     8,3 |                       2,8 |          624,1 |                    4,9 |
|   262144 |                    18,7 |                       6,3 |        1.247,8 |                    4,9 |
|   524288 |                    40,0 |                      15,2 |        2.495,4 |                    4,9 |
|  1048576 |                    87,3 |                      33,6 |        4.990,6 |                    4,9 |
|  2097152 |                   178,9 |                      70,3 |        9.981,7 |                    4,9 |

### List<int> with limited size:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,0 |            8,1 |                    1,0 |
|    16384 |                     0,0 |                       0,0 |           16,1 |                    1,0 |
|    32768 |                     0,0 |                       0,0 |           32,1 |                    1,0 |
|    65536 |                     1,0 |                       0,0 |           64,1 |                    1,0 |
|   131072 |                     3,3 |                       1,2 |          128,1 |                    1,0 |
|   262144 |                     8,6 |                       5,2 |          256,1 |                    1,0 |
|   524288 |                    18,6 |                      11,5 |          512,1 |                    1,0 |
|  1048576 |                    41,1 |                      28,4 |        1.024,1 |                    1,0 |
|  2097152 |                    84,8 |                      56,6 |        2.048,1 |                    1,0 |

### List<double>:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,1 |                       0,1 |           64,1 |                    8,0 |
|    16384 |                     0,1 |                       0,1 |          128,1 |                    8,0 |
|    32768 |                     1,1 |                       1,1 |          256,1 |                    8,0 |
|    65536 |                     3,2 |                       3,5 |          512,1 |                    8,0 |
|   131072 |                     7,1 |                       7,5 |        1.024,1 |                    8,0 |
|   262144 |                    16,2 |                      17,0 |        2.048,1 |                    8,0 |
|   524288 |                    36,8 |                      38,0 |        4.096,1 |                    8,0 |
|  1048576 |                    77,8 |                      80,3 |        8.192,1 |                    8,0 |
|  2097152 |                   167,8 |                     164,6 |       16.384,1 |                    8,0 |

### ushort[]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,5 |                       0,4 |           22,1 |                    2,8 |
|    16384 |                     0,8 |                       0,4 |           44,2 |                    2,8 |
|    32768 |                     2,0 |                       1,4 |           88,0 |                    2,8 |
|    65536 |                     5,1 |                       3,1 |          176,1 |                    2,8 |
|   131072 |                    12,3 |                       6,4 |          352,0 |                    2,8 |
|   262144 |                    26,3 |                      14,1 |          703,5 |                    2,7 |
|   524288 |                    53,6 |                      31,3 |        1.406,8 |                    2,7 |
|  1048576 |                   111,5 |                      65,2 |        2.813,5 |                    2,7 |
|  2097152 |                   223,5 |                     129,3 |        5.627,3 |                    2,7 |

### int[,]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,1 |           38,7 |                    4,8 |
|    16384 |                     0,0 |                       0,2 |           78,1 |                    4,9 |
|    32768 |                     1,0 |                       1,3 |          156,0 |                    4,9 |
|    65536 |                     3,3 |                       4,1 |          312,0 |                    4,9 |
|   131072 |                     8,2 |                       9,7 |          624,0 |                    4,9 |
|   262144 |                    17,8 |                      21,6 |        1.247,9 |                    4,9 |
|   524288 |                    38,3 |                      45,3 |        2.494,9 |                    4,9 |
|  1048576 |                    85,4 |                      94,4 |        4.990,6 |                    4,9 |
|  2097152 |                   174,6 |                     194,5 |        9.979,5 |                    4,9 |

### int[,,]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,0 |           38,2 |                    4,8 |
|    16384 |                     0,0 |                       0,0 |           74,4 |                    4,7 |
|    32768 |                     1,0 |                       1,0 |          142,0 |                    4,4 |
|    65536 |                     3,2 |                       3,0 |          304,9 |                    4,8 |
|   131072 |                     8,2 |                       9,0 |          595,2 |                    4,7 |
|   262144 |                    18,4 |                      18,1 |        1.190,1 |                    4,6 |
|   524288 |                    39,0 |                      38,0 |        2.436,8 |                    4,8 |
|  1048576 |                    85,4 |                      78,4 |        4.903,5 |                    4,8 |
|  2097152 |                   173,1 |                     159,3 |        9.749,4 |                    4,8 |

### int[,,,]:
| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                     0,0 |                       0,9 |           31,4 |                    3,9 |
|    16384 |                     0,0 |                       2,9 |           69,8 |                    4,4 |
|    32768 |                     1,0 |                       6,9 |          136,1 |                    4,3 |
|    65536 |                     3,1 |                      16,6 |          312,1 |                    4,9 |
|   131072 |                     9,3 |                      36,4 |          620,5 |                    4,8 |
|   262144 |                    19,0 |                      70,2 |        1.115,1 |                    4,4 |
|   524288 |                    39,1 |                     137,8 |        2.175,2 |                    4,2 |
|  1048576 |                    84,8 |                     293,1 |        4.990,8 |                    4,9 |
|  2097152 |                   173,8 |                     602,5 |        9.924,4 |                    4,8 |

### Linked list:
```csharp
    [StorableType("B9C2AA20-A18C-4124-90B8-B181BF7691B4")]
    private class ListNode {
      [Storable]
      public ListNode Next;
    }
    public static object MakeLinkedList(int size, Random rand) {
      var first = new ListNode();
      var cur = first;
      for (int i = 0; i < size; i++) {
        cur.Next = new ListNode();
        cur = cur.Next;
      }
      return first;
    }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                    32,8 |                      26,1 |          136,0 |                   17,0 |
|    16384 |                    72,4 |                      77,4 |          272,0 |                   17,0 |
|    32768 |                   161,1 |                     215,5 |          560,0 |                   17,5 |
|    65536 |                   374,8 |                     482,1 |        1.136,0 |                   17,8 |
|   131072 |                   808,9 |                     941,7 |        2.288,0 |                   17,9 |
|   262144 |                 1.668,7 |                   1.842,6 |        4.592,0 |                   17,9 |
|   524288 |                 3.363,4 |                   3.509,9 |        9.200,0 |                   18,0 |
|  1048576 |                 7.184,9 |                   7.322,6 |       18.416,0 |                   18,0 |
|  2097152 |                16.121,5 |                  16.142,2 |       36.848,0 |                   18,0 |


### Random graph of nodes:  
```csharp
      int maxChildren = 20;
      var allNodes = new List<Node>();
      allNodes.Add(new Node()); // start with at least one node
      for (int i = 0; i < size; i++) {
        var node = new Node();
        var numChildren = rand.Next(maxChildren) + 1;
        for (int j = 0; j < numChildren; j++) {
          node.children.Add(allNodes[rand.Next(allNodes.Count)]);
        }
        allNodes.Add(node);
      }
```

| Elements | Serialization time (ms) | Deserialization time (ms) | File size (kB) | avg. bytes per element |
|---------:|------------------------:|--------------------------:|---------------:|------------------------|
|     8192 |                    89,6 |                     134,2 |          411,8 |                   51,5 |
|    16384 |                   297,8 |                     434,6 |          841,6 |                   52,6 |
|    32768 |                   789,4 |                     960,0 |        1.754,7 |                   54,8 |
|    65536 |                 1.650,4 |                   1.838,7 |        3.702,2 |                   57,8 |
|   131072 |                 3.177,1 |                   3.284,2 |        7.714,7 |                   60,3 |
|   262144 |                 6.399,3 |                   6.188,9 |       15.836,3 |                   61,9 |
|   524288 |                12.636,4 |                  11.674,2 |       32.247,0 |                   63,0 |
|  1048576 |                25.381,7 |                  22.635,7 |       65.159,3 |                   63,6 |
|  2097152 |                51.179,0 |                  43.322,8 |      133.119,9 |                   65,0 |

